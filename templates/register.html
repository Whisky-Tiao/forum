{% extends "base.html" %}

{% block title %}
    {% if get_locale() == 'zh' %}注册 - 大学腾飞营论坛{% else %}Register - University Forum{% endif %}
{% endblock %}

{% block content %}
<div class="row justify-content-center">
    <div class="col-md-6 col-lg-5">
        <div class="card">
            <div class="card-header text-center">
                <h4 class="mb-0">
                    {% if get_locale() == 'zh' %}
                        <i class="fas fa-user-plus me-2"></i>用户注册
                    {% else %}
                        <i class="fas fa-user-plus me-2"></i>User Registration
                    {% endif %}
                </h4>
            </div>
            <div class="card-body">
                <form method="POST" id="registerForm">
                    <div class="mb-3">
                        <label for="username" class="form-label">
                            {% if get_locale() == 'zh' %}用户名{% else %}Username{% endif %}
                        </label>
                        <input type="text" class="form-control" id="username" name="username" required>
                        <div class="form-text">
                            {% if get_locale() == 'zh' %}
                                用户名长度3-20个字符，只能包含字母、数字和下划线
                            {% else %}
                                Username must be 3-20 characters, letters, numbers and underscores only
                            {% endif %}
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="email" class="form-label">
                            {% if get_locale() == 'zh' %}邮箱{% else %}Email{% endif %}
                        </label>
                        <input type="email" class="form-control" id="email" name="email" required>
                    </div>
                    
                    <div class="mb-3">
                        <label for="password" class="form-label">
                            {% if get_locale() == 'zh' %}密码{% else %}Password{% endif %}
                        </label>
                        <input type="password" class="form-control" id="password" name="password" required>
                        <div class="password-requirements mt-2">
                            <small class="text-muted">
                                {% if get_locale() == 'zh' %}密码要求：{% else %}Password requirements:{% endif %}
                            </small>
                            <ul class="list-unstyled mt-1">
                                <li id="length-check" class="text-danger">
                                    <i class="fas fa-times me-1"></i>
                                    {% if get_locale() == 'zh' %}至少8个字符{% else %}At least 8 characters{% endif %}
                                </li>
                                <li id="uppercase-check" class="text-danger">
                                    <i class="fas fa-times me-1"></i>
                                    {% if get_locale() == 'zh' %}至少一个大写字母{% else %}At least one uppercase letter{% endif %}
                                </li>
                                <li id="lowercase-check" class="text-danger">
                                    <i class="fas fa-times me-1"></i>
                                    {% if get_locale() == 'zh' %}至少一个小写字母{% else %}At least one lowercase letter{% endif %}
                                </li>
                                <li id="number-check" class="text-danger">
                                    <i class="fas fa-times me-1"></i>
                                    {% if get_locale() == 'zh' %}至少一个数字{% else %}At least one number{% endif %}
                                </li>
                                <li id="special-check" class="text-danger">
                                    <i class="fas fa-times me-1"></i>
                                    {% if get_locale() == 'zh' %}至少一个特殊字符{% else %}At least one special character{% endif %}
                                </li>
                            </ul>
                        </div>
                    </div>
                    
                    <div class="mb-3">
                        <label for="confirm_password" class="form-label">
                            {% if get_locale() == 'zh' %}确认密码{% else %}Confirm Password{% endif %}
                        </label>
                        <input type="password" class="form-control" id="confirm_password" name="confirm_password" required>
                        <div id="password-match" class="form-text text-danger" style="display: none;">
                            {% if get_locale() == 'zh' %}密码不匹配{% else %}Passwords do not match{% endif %}
                        </div>
                    </div>
                    
                    <div class="d-grid">
                        <button type="submit" class="btn btn-primary" id="submit-btn" disabled>
                            {% if get_locale() == 'zh' %}
                                <i class="fas fa-user-plus me-1"></i>注册
                            {% else %}
                                <i class="fas fa-user-plus me-1"></i>Register
                            {% endif %}
                        </button>
                    </div>
                </form>
                
                <hr>
                
                <div class="text-center">
                    <p class="text-muted mb-0">
                        {% if get_locale() == 'zh' %}
                            已有账号？
                        {% else %}
                            Already have an account?
                        {% endif %}
                        <a href="{{ url_for('login') }}" class="text-decoration-none">
                            {% if get_locale() == 'zh' %}立即登录{% else %}Login now{% endif %}
                        </a>
                    </p>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block extra_js %}
<script>
$(document).ready(function() {
    var password = $('#password');
    var confirmPassword = $('#confirm_password');
    var submitBtn = $('#submit-btn');
    
    function validatePassword() {
        var pwd = password.val();
        var isValid = true;
        
        // Length check
        if (pwd.length >= 8) {
            $('#length-check').removeClass('text-danger').addClass('text-success');
            $('#length-check i').removeClass('fa-times').addClass('fa-check');
        } else {
            $('#length-check').removeClass('text-success').addClass('text-danger');
            $('#length-check i').removeClass('fa-check').addClass('fa-times');
            isValid = false;
        }
        
        // Uppercase check
        if (/[A-Z]/.test(pwd)) {
            $('#uppercase-check').removeClass('text-danger').addClass('text-success');
            $('#uppercase-check i').removeClass('fa-times').addClass('fa-check');
        } else {
            $('#uppercase-check').removeClass('text-success').addClass('text-danger');
            $('#uppercase-check i').removeClass('fa-check').addClass('fa-times');
            isValid = false;
        }
        
        // Lowercase check
        if (/[a-z]/.test(pwd)) {
            $('#lowercase-check').removeClass('text-danger').addClass('text-success');
            $('#lowercase-check i').removeClass('fa-times').addClass('fa-check');
        } else {
            $('#lowercase-check').removeClass('text-success').addClass('text-danger');
            $('#lowercase-check i').removeClass('fa-check').addClass('fa-times');
            isValid = false;
        }
        
        // Number check
        if (/\d/.test(pwd)) {
            $('#number-check').removeClass('text-danger').addClass('text-success');
            $('#number-check i').removeClass('fa-times').addClass('fa-check');
        } else {
            $('#number-check').removeClass('text-success').addClass('text-danger');
            $('#number-check i').removeClass('fa-check').addClass('fa-times');
            isValid = false;
        }
        
        // Special character check
        if (/[!@#$%^&*(),.?":{}|<>]/.test(pwd)) {
            $('#special-check').removeClass('text-danger').addClass('text-success');
            $('#special-check i').removeClass('fa-times').addClass('fa-check');
        } else {
            $('#special-check').removeClass('text-success').addClass('text-danger');
            $('#special-check i').removeClass('fa-check').addClass('fa-times');
            isValid = false;
        }
        
        return isValid;
    }
    
    function validateForm() {
        var passwordValid = validatePassword();
        var passwordsMatch = password.val() === confirmPassword.val();
        var usernameValid = $('#username').val().length >= 3;
        var emailValid = $('#email').val().includes('@');
        
        if (passwordsMatch) {
            $('#password-match').hide();
        } else {
            $('#password-match').show();
        }
        
        if (passwordValid && passwordsMatch && usernameValid && emailValid) {
            submitBtn.prop('disabled', false);
        } else {
            submitBtn.prop('disabled', true);
        }
    }
    
    password.on('input', validateForm);
    confirmPassword.on('input', validateForm);
    $('#username').on('input', validateForm);
    $('#email').on('input', validateForm);
    
    // Initial validation
    validateForm();
});
</script>
{% endblock %} 